version: '3.6'
services:
  redis3single:
    image: redis:3.0
    command: redis-server --port 7101
    ports:
      - "7101"
  redis4single:
    image: redis:4.0
    command: redis-server --port 7102
    ports:
      - "7102"
  redis5single:
    image: redis:5.0
    command: redis-server --port 7103
    ports:
      - "7103"
  redis3cluster:
    build: redis3-cluster
    command: create-cluster-ruby.sh 7001 7006
    ports:
      - "7001:7001"
      - "7002:7002"
      - "7003:7003"
      - "7004:7004"
      - "7005:7005"
      - "7006:7006"
    volumes:
      - ./create-cluster-ruby.sh:/usr/local/bin/create-cluster-ruby.sh
  redis4cluster:
    build: redis4-cluster
    command: create-cluster-ruby.sh 7011 7016
    ports:
      - "7011:7011"
      - "7012:7012"
      - "7013:7013"
      - "7014:7014"
      - "7015:7015"
      - "7016:7016"
    volumes:
      - ./create-cluster-ruby.sh:/usr/local/bin/create-cluster-ruby.sh
  redis5cluster:
    image: redis:5.0
    command: create-cluster.sh 7021 7026
    ports:
      - "7021:7021"
      - "7022:7022"
      - "7023:7023"
      - "7024:7024"
      - "7025:7025"
      - "7026:7026"
    volumes:
      - ./create-cluster.sh:/usr/local/bin/create-cluster.sh